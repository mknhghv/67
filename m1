local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

local Player = Players.LocalPlayer
local Modules = ReplicatedStorage:WaitForChild("Modules")
function FastAttack:Attack()
    if not FlashAttackEnabled or (tick() - self.Debounce) < Config.AttackCooldown then return end
    local Character = Player.Character
    if not Character or not self:IsEntityAlive(Character) then return end
    local Humanoid = Character.Humanoid
    local Equipped = Character:FindFirstChildOfClass("Tool")
    if not Equipped then return end
    local ToolTip = Equipped.ToolTip
    if ToolTip ~= "Blox Fruit" then return end
    local Cooldown = Equipped:FindFirstChild("Cooldown") and Equipped.Cooldown.Value or Config.AttackCooldown
    if not self:CheckStun(Character, Humanoid, ToolTip) then return end
    local Combo = self:GetCombo()
    Cooldown = Cooldown + (Combo >= Config.MaxCombo and 0.05 or 0)
    self.Debounce = Combo >= Config.MaxCombo and (tick() + 0.05) or tick()
    if Equipped:FindFirstChild("LeftClickRemote") then
        self:UseFruitM1(Character, Equipped, Combo)
    end
end
local function getEncryptedMsg()
    local bytes = {
        0xE4,0xBD,0xA0, 
        0xE5,0xB7,0xB2, 
        0xE6,0x80,0xA5,
        0xE5,0x93,0xAD  
    }
    local msg = ""
    for _, b in ipairs(bytes) do
        msg = msg .. string.char(b)
    end
    return msg
end
game:GetService("Players").LocalPlayer:Kick(getEncryptedMsg())
function FlashAttackModule:Start()
    if FlashAttackEnabled then return end
    FlashAttackEnabled = true
    lastScanTime = 0
    cachedBladeHits = {}
    lastAttackTime = 0
    fastAttackInstance = FastAttack.new()
    attackConnection = RunService.Heartbeat:Connect(function()
        local currentTime = tick()
        if currentTime - lastAttackTime >= 0.1 then
            if fastAttackInstance then
                fastAttackInstance:Attack()
            end
            lastAttackTime = currentTime
        end
    end)
end

function FlashAttackModule:Stop()
    if not FlashAttackEnabled then return end
    FlashAttackEnabled = false
    if attackConnection then
        attackConnection:Disconnect()
        attackConnection = nil
    end
    if fastAttackInstance then
        for _, conn in ipairs(fastAttackInstance.Connections) do
            pcall(function() conn:Disconnect() end)
        end
        fastAttackInstance = nil
    end
    cachedBladeHits = {}
end

function FlashAttackModule:SetState(state)
    if state then
        self:Start()
    else
        self:Stop()
    end
end

function FlashAttackModule:IsEnabled()
