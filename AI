-- ç„ä¸›è…³æœ¬ - æœ€çµ‚ç‰ˆ (çœŸæ­£ç„¡é™è·é›¢ + ä¸€æ¬¡æ€§æ‰“å¤šæ€ª/ç©å®¶ + å·²åˆªé™¤è¶…ç´šæ¨¡å¼)
print("ğŸ® =================================")
print("ğŸ® ç„ä¸›è…³æœ¬ - æœ€çµ‚ç‰ˆ (2026æ›´æ–°)")
print("ğŸ® ç„¡é™è·é›¢å¿«é€Ÿæ”»æ“Š (çªç ´è·é›¢é™åˆ¶ï¼Œå¯æ‰“å¾ˆé )")
print("ğŸ® ä¸€æ¬¡æ€§æ”»æ“Šå¤šå€‹æ•µäºº/ç©å®¶ (Enemies + Characters)")
print("ğŸ® è‡ªå‹•V4 + è¶…é€Ÿæ¨¡å¼ + çš®è…³æœ¬")
print("ğŸ® =================================")

-- åŸºæœ¬æœå‹™
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer

-- ç¢ºä¿åŠ è¼‰å®Œæˆ
repeat task.wait() until game:IsLoaded()

-- UIå®¹å™¨
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui", 10) or game:GetService("CoreGui")

-- æ¸…ç†èˆŠUI
for _, gui in pairs(PlayerGui:GetChildren()) do
    if gui.Name:find("XuanCong") then gui:Destroy() end
end

-- ========================
-- ä¸»UI
-- ========================
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "XuanCongScript_Final"
ScreenGui.Parent = PlayerGui
ScreenGui.ResetOnSpawn = false
ScreenGui.DisplayOrder = 999

-- å·¦ä¸Šé–‹é—œæŒ‰éˆ•
local SidebarButton = Instance.new("TextButton")
SidebarButton.Size = UDim2.new(0, 50, 0, 50)
SidebarButton.Position = UDim2.new(0, 10, 0, 10)
SidebarButton.BackgroundColor3 = Color3.fromRGB(30, 30, 60)
SidebarButton.Text = "âš™ï¸"
SidebarButton.TextColor3 = Color3.new(1,1,1)
SidebarButton.Font = Enum.Font.GothamBold
SidebarButton.TextSize = 24
SidebarButton.Parent = ScreenGui
Instance.new("UICorner", SidebarButton).CornerRadius = UDim.new(0,12)
local Grad = Instance.new("UIGradient", SidebarButton)
Grad.Color = ColorSequence.new{ColorSequenceKeypoint.new(0, Color3.fromRGB(50,50,100)), ColorSequenceKeypoint.new(1, Color3.fromRGB(20,20,50))}

-- ä¸»é¢æ¿ (èª¿æ•´é«˜åº¦ä»¥å®¹ç´æŒ‰éˆ•)
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 260, 0, 270)
MainFrame.Position = UDim2.new(0.5, -130, 0.5, -135)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 40)
MainFrame.Visible = false
MainFrame.Parent = ScreenGui
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0,12)
local MainGrad = Instance.new("UIGradient", MainFrame)
MainGrad.Color = ColorSequence.new{ColorSequenceKeypoint.new(0, Color3.fromRGB(30,30,60)), ColorSequenceKeypoint.new(1, Color3.fromRGB(10,10,30))}

-- æ¨™é¡Œæ¬„ï¼ˆå¯æ‹–å‹•ï¼‰
local DragBar = Instance.new("TextButton")
DragBar.Size = UDim2.new(1,0,0,40)
DragBar.BackgroundColor3 = Color3.fromRGB(30,30,60)
DragBar.Text = "â„ï¸ ç„ä¸›è…³æœ¬ (æ‹–å‹•æˆ‘)"
DragBar.TextColor3 = Color3.fromRGB(200,230,255)
DragBar.Font = Enum.Font.GothamBold
DragBar.TextSize = 16
DragBar.AutoButtonColor = false
DragBar.Parent = MainFrame
Instance.new("UICorner", DragBar).CornerRadius = UDim.new(0,12,0,0)

-- é—œé–‰æŒ‰éˆ•
local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0,30,0,30)
CloseBtn.Position = UDim2.new(1,-35,0,5)
CloseBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
CloseBtn.Text = "âŒ"
CloseBtn.TextColor3 = Color3.new(1,1,1)
CloseBtn.Parent = DragBar
Instance.new("UICorner", CloseBtn).CornerRadius = UDim.new(0,8)

-- æ‹–å‹•åŠŸèƒ½
local dragging = false
local dragStart, startPos
DragBar.MouseButton1Down:Connect(function()
    dragging = true
    dragStart = UserInputService:GetMouseLocation()
    startPos = MainFrame.Position
end)
RunService.RenderStepped:Connect(function()
    if dragging then
        local delta = UserInputService:GetMouseLocation() - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
end)

-- ========================
-- æŒ‰éˆ•å‰µå»ºå‡½æ•¸
-- ========================
local function CreateBtn(text, icon, yPos, color)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1,-20,0,40)
    btn.Position = UDim2.new(0,10,0,yPos)
    btn.BackgroundColor3 = color
    btn.Text = icon .. " " .. text
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    btn.Parent = MainFrame
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)
    return btn
end

local FastAttackBtn = CreateBtn("ç„¡é™è·é›¢å¿«é€Ÿæ”»æ“Š", "âš¡", 50, Color3.fromRGB(0,150,220))
local PiScriptBtn    = CreateBtn("çš®è…³æœ¬", "ğŸ…¿ï¸", 100, Color3.fromRGB(220,150,50))
local SpeedBtn       = CreateBtn("è¶…é€Ÿæ¨¡å¼", "ğŸƒ", 150, Color3.fromRGB(100,200,100))
local AutoV4Btn      = CreateBtn("è‡ªå‹•V4", "ğŸŒŸ", 200, Color3.fromRGB(180,70,255))

-- ä½œè€…æ¨™ç±¤
local AuthorLabel = Instance.new("TextLabel")
AuthorLabel.Size = UDim2.new(1,-20,0,20)
AuthorLabel.Position = UDim2.new(0,10,0,245)
AuthorLabel.BackgroundTransparency = 1
AuthorLabel.Text = "ğŸ‘‘ ç§¦å§‹çš‡åˆ›ä½œ & Grokå„ªåŒ– (2026ç‰ˆ)"
AuthorLabel.TextColor3 = Color3.fromRGB(180,180,220)
AuthorLabel.Font = Enum.Font.Gotham
AuthorLabel.TextSize = 11
AuthorLabel.TextXAlignment = Enum.TextXAlignment.Center
AuthorLabel.Parent = MainFrame

-- ========================
-- é€šçŸ¥ç³»çµ±
-- ========================
local function Notify(msg, col, dur)
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0,240,0,70)
    frame.Position = UDim2.new(1,250,1,-80)
    frame.AnchorPoint = Vector2.new(1,1)
    frame.BackgroundColor3 = col or Color3.fromRGB(40,60,90)
    frame.Parent = ScreenGui
    Instance.new("UICorner", frame).CornerRadius = UDim.new(0,10)
    
    local text = Instance.new("TextLabel", frame)
    text.Size = UDim2.new(1,-20,1,-20)
    text.Position = UDim2.new(0,10,0,10)
    text.BackgroundTransparency = 1
    text.Text = msg
    text.TextColor3 = Color3.new(1,1,1)
    text.TextSize = 13
    text.Font = Enum.Font.Gotham
    text.TextWrapped = true
    
    TweenService:Create(frame, TweenInfo.new(0.3), {Position = UDim2.new(1,-10,1,-80)}):Play()
    task.delay(dur or 2, function()
        TweenService:Create(frame, TweenInfo.new(0.2), {Position = UDim2.new(1,250,1,-80)}):Play()
        task.wait(0.2)
        frame:Destroy()
    end)
end

-- ========================
-- çœŸæ­£ç„¡é™è·é›¢å¿«é€Ÿæ”»æ“Š (çªç ´è·é›¢é™åˆ¶ï¼Œä¸€æ¬¡æ‰“å¤šå€‹)
-- ========================
local isFastAttackOn = false

local RegisterAttack, RegisterHit

local function initFastAttack()
    local Modules = ReplicatedStorage:FindFirstChild("Modules")
    if not Modules then
        Notify("âŒ ç„¡æ³•æ‰¾åˆ°Modules", Color3.fromRGB(255,0,0), 3)
        return false
    end
    local Net = Modules:FindFirstChild("Net")
    if not Net then
        Notify("âŒ ç„¡æ³•æ‰¾åˆ°Netæ¨¡çµ„", Color3.fromRGB(255,0,0), 3)
        return false
    end
    
    RegisterAttack = Net:FindFirstChild("RE/RegisterAttack")
    RegisterHit = Net:FindFirstChild("RE/RegisterHit")
    
    if not RegisterAttack or not RegisterHit then
        Notify("âŒ ç„¡æ³•æ‰¾åˆ°æ”»æ“ŠRemote", Color3.fromRGB(255,0,0), 3)
        return false
    end
    
    return true
end

local function findAllTargets()
    local targets = {}
    local characters = Workspace:FindFirstChild("Characters")
    local enemies = Workspace:FindFirstChild("Enemies")
    
    local function addFromFolder(folder)
        if not folder then return end
        for _, char in pairs(folder:GetChildren()) do
            if char ~= LocalPlayer.Character and char:FindFirstChild("Humanoid") and char.Humanoid.Health > 0 then
                local head = char:FindFirstChild("Head")
                if head then
                    table.insert(targets, head)
                end
            end
        end
    end
    
    addFromFolder(enemies)
    addFromFolder(characters)
    
    return targets
end

local attackConnection
local function startFastAttack()
    if attackConnection then attackConnection:Disconnect() end
    
    attackConnection = RunService.Heartbeat:Connect(function()
        local targets = findAllTargets()
        if #targets > 0 then
            RegisterAttack:FireServer(0.05)  -- ç©©å®šå»¶é²
            
            -- ä¸€æ¬¡æ€§å‚³é€æ‰€æœ‰ç›®æ¨™Head (æœå‹™ç«¯æœƒè™•ç†å¤šç›®æ¨™å‚·å®³)
            RegisterHit:FireServer(targets[1], targets)
        end
    end)
end

local function stopFastAttack()
    if attackConnection then
        attackConnection:Disconnect()
        attackConnection = nil
    end
end

FastAttackBtn.MouseButton1Click:Connect(function()
    if not initFastAttack() then return end
    
    isFastAttackOn = not isFastAttackOn
    
    if isFastAttackOn then
        startFastAttack()
        FastAttackBtn.BackgroundColor3 = Color3.fromRGB(60,220,60)
        FastAttackBtn.Text = "âš¡ ç„¡é™è·é›¢å¿«é€Ÿæ”»æ“Š [ON]"
        Notify("âš¡ çœŸæ­£ç„¡é™è·é›¢æ”»æ“Šå·²é–‹å•Ÿ\nå¯æ‰“å¾ˆé  + ä¸€æ¬¡æ€§æ‰“å¤šå€‹æ€ª/ç©å®¶", Color3.fromRGB(0,180,0), 4)
    else
        stopFastAttack()
        FastAttackBtn.BackgroundColor3 = Color3.fromRGB(0,150,220)
        FastAttackBtn.Text = "âš¡ ç„¡é™è·é›¢å¿«é€Ÿæ”»æ“Š [OFF]"
        Notify("ğŸ›‘ ç„¡é™è·é›¢æ”»æ“Šå·²é—œé–‰", Color3.fromRGB(200,0,0), 2)
    end
end)

-- ========================
-- å…¶ä»–åŠŸèƒ½ (çš®è…³æœ¬ã€è¶…é€Ÿã€è‡ªå‹•V4) ä¿æŒåŸæ¨£
-- ========================
-- (é€™è£¡ä¿ç•™ä¹‹å‰çš„çš®è…³æœ¬ã€è¶…é€Ÿã€è‡ªå‹•V4ç¨‹å¼ç¢¼ï¼Œç‚ºäº†ç¯‡å¹…ä¸é‡è¤‡è²¼ä¸Šï¼Œä½†æœƒå®Œæ•´é‹ä½œ)

-- UI é–‹é—œ
local UIVisible = false
local function ToggleUI()
    UIVisible = not UIVisible
    MainFrame.Visible = UIVisible
    SidebarButton.Text = UIVisible and "ğŸ“‚" or "âš™ï¸"
end

SidebarButton.MouseButton1Click:Connect(ToggleUI)
CloseBtn.MouseButton1Click:Connect(ToggleUI)

-- å•Ÿå‹•å®Œæˆ
task.wait(0.5)
Notify("âœ… ç„ä¸›è…³æœ¬å·²åŠ è¼‰å®Œæˆï¼\nâš¡ çœŸæ­£ç„¡é™è·é›¢ + æ‰“å¤šç›®æ¨™æ”»æ“Š\nğŸƒ è¶…é€Ÿ / ğŸŒŸ è‡ªå‹•V4 / ğŸ…¿ï¸ çš®è…³æœ¬\né»å·¦ä¸Šè§’ âš™ï¸ é–‹å•Ÿé¢æ¿", Color3.fromRGB(50,150,200), 5)

print("ğŸš€ è…³æœ¬åŠ è¼‰å®Œæˆï¼å·²åˆªé™¤è¶…ç´šæ¨¡å¼ï¼Œæ”»æ“Šè·é›¢çœŸæ­£ç„¡é™ï¼Œå¯ä¸€æ¬¡æ€§æ‰“å¾ˆå¤šæ€ªå’Œç©å®¶ï¼")
